import{preloadImages}from"../../libs/utils.js";$=jQuery;let lenis=new Lenis;function customDropdown(){let e=document.querySelectorAll(".dropdown-custom");function r(o){e.forEach(e=>{var t=e.querySelector(".dropdown-custom-menu"),i=e.querySelector(".dropdown-custom-btn");o&&e===o||(t.classList.remove("dropdown--active"),i.classList.remove("--active"))})}e.forEach(t=>{let i=t.querySelector(".dropdown-custom-btn"),o=t.querySelector(".dropdown-custom-menu");var e=t.querySelectorAll(".dropdown-custom-item");let n=t.querySelector(".value-select");i.addEventListener("click",function(e){e.stopPropagation(),r(t),o.classList.toggle("dropdown--active"),i.classList.toggle("--active")}),document.addEventListener("click",function(){r()}),e.forEach(o=>{o.addEventListener("click",function(e){e.stopPropagation();var e=n.querySelector("img").src,t=n.querySelector("span").textContent,i=(n.innerHTML,o.innerHTML);n.innerHTML=i,o.innerHTML=`<img src="${e}" alt="" /><span>${t}</span>`,r()})}),window.addEventListener("scroll",function(){r()})})}function bookingForm(){var i;document.querySelector(".banner-booking")&&(i=new Lightpick({field:document.getElementById("check-in"),secondField:document.getElementById("check-out"),singleDate:!1,minDate:moment().startOf("now"),numberOfMonths:2,onOpen:function(){var e=i._opts.field.getBoundingClientRect(),t=i.el;e.top>=window.innerHeight/2?t.style.top=e.top+window.scrollY-t.offsetHeight+"px":t.style.top=e.bottom+window.scrollY+"px",t.style.left=e.left+window.scrollX+"px"}}),document.querySelectorAll(".people, .child").forEach(e=>{let t=e.querySelector(".min");var i=e.querySelector(".plus");let o=e.querySelector(".val");i.onclick=()=>{var e=parseInt(o.textContent);o.textContent=Math.min(e+1,10),t.style.opacity=0<o.textContent?"1":"0.5"},t.onclick=()=>{var e=parseInt(o.textContent),e=Math.max(e-1,0);o.textContent=e,t.style.opacity=0<e?"1":"0.5"}}))}function sectionAccommodation(){$("section.accommodation").length<1||$("section.accommodation").each(function(){var e=$(this),t=e.find(".accommodation-slider__main"),i=e.find(".swiper-pagination"),o=e.find(".swiper-button-prev"),e=e.find(".swiper-button-next"),n=t.hasClass("offer-slider"),n=767<$(window).width()?n?2.5:3.3:1.2,r=767<$(window).width()?40:24;new Swiper(t[0],{spaceBetween:r,slidesPerView:n,speed:1e3,slidesOffsetAfter:80,pagination:{el:i[0],type:"progressbar"},navigation:{prevEl:o[0],nextEl:e[0]}})})}function swiperFacility(){document.querySelectorAll(".swiper-facility").forEach(e=>{let i;new Swiper(e,{slidesPerView:1,watchSlidesProgress:!0,speed:1500,loop:!0,autoplay:{delay:3e3},pagination:{el:e.querySelector(".swiper-pagination"),clickable:!0,renderBullet:function(e,t){return`
            <button class="${t}">
              <span class="progress-bar"></span>
            </button>`}},on:{init(e){e.slides.forEach(e=>{e=e.querySelector(".caption");e&&(e.style.opacity="0",e.style.transition="opacity 0.6s ease")});let t=e.slides[e.activeIndex]?.querySelector(".caption");t&&(t.style.opacity="1",i=setTimeout(()=>{t.style.opacity="0"},2200))},slideChangeTransitionStart(e){e.params.autoplay.delay=3e3,e.autoplay.start(),e.slides.forEach(e=>{e=e.querySelector(".caption");e&&(e.style.opacity="0")}),clearTimeout(i)},slideChangeTransitionEnd(e){var o;(o=e).pagination.bullets.forEach((e,t)=>{let i=e.querySelector(".progress-bar");t<o.realIndex?(e.classList.add("viewed"),i.style.width="100%",i.style.transition="none"):t===o.realIndex?(i.style.width="0%",i.style.transition="none",setTimeout(()=>{i.style.width="100%",i.style.transition=`width ${o.params.autoplay.delay}ms linear`},10)):(e.classList.remove("viewed"),i.style.width="0%",i.style.transition="none")});let t=e.slides[e.activeIndex]?.querySelector(".caption");t&&(t.style.opacity="1",i=setTimeout(()=>{t.style.opacity="0"},2200))},progress(i){i.slides.forEach(e=>{var t=(e.progress||0)*(.9*i.width),e=e.querySelector(".box-img");e&&!isNaN(t)&&(e.style.transform=`translate3d(${t}px, 0, 0)`)})},touchStart(e){e.slides.forEach(e=>{e.style.transition=""}),clearTimeout(i)},setTransition(e,t){let i="cubic-bezier(0.25, 0.1, 0.25, 1)";e.slides.forEach(e=>{e.style.transition=t+"ms "+i;e=e.querySelector(".box-img");e&&(e.style.transition=t+"ms "+i)})}}})})}function swiperAccommodation(){$(".swiper-accomodation").length<1||$(".accommodation-detail").each(function(){var o=$(this).find(".swiper-accomodation"),n=o.closest(".detail-gallery").find(".swiper-pagination"),r=o.closest(".detail-gallery").find(".swiper-button-prev"),s=o.closest(".detail-gallery").find(".swiper-button-next"),l=$(window).width()<992?1:2.5;let a=new Swiper(o[0],{slidesPerView:l,spaceBetween:24,slidesOffsetAfter:0,speed:1e3,parallax:!0,pagination:{el:n[0],type:"progressbar"},navigation:{prevEl:r[0],nextEl:s[0]}});l=o.find(".swiper-slide").first().data("bs-target");let c=$(l);if(c.length){let e=null,t=!1,i=(o.find(".swiper-slide").on("click",function(){$(this).index();c.modal("show")}),c.find(".swiper-accomodation-gallery"));n=c.find(".swiper-pagination"),r=c.find(".swiper-button-prev"),s=c.find(".swiper-button-next"),l=$(window).width()<992?1:"auto";e=new Swiper(i[0],{slidesPerView:l,slidesOffsetAfter:0,spaceBetween:24,speed:1e3,parallax:!0,pagination:{el:n[0],type:"progressbar"},navigation:{prevEl:r[0],nextEl:s[0]},breakpoints:{991:{spaceBetween:40,slidesPerView:"auto"}},on:{slideChange:function(){t||(t=!0,a.slideTo(e.activeIndex,0),t=!1)},init:function(){i.removeClass("swiper-hidden").addClass("swiper-visible")}}})}})}function ctaMess(){ScrollTrigger.create({start:"top top",end:99999,paused:!0,onUpdate:e=>{1===e.direction?$("#cta-mess").addClass("hide"):$("#cta-mess").removeClass("hide")}})}function distortionImg(){document.querySelectorAll(".distortion-img").forEach(e=>{var t,i=e.querySelector("img");i&&(t=i.src,i.style.display="none",new hoverEffect({parent:e,intensity:.1,angle:0,image1:t,image2:t,displacementImage:"./assets/images/distortion/ripple.jpg"}))})}function loadingBanner(){let t=!1;$(".banner-hero-clip").length<1||gsap.timeline({scrollTrigger:{trigger:".banner-hero-clip",start:"top top",scrub:!0,pin:!0,once:!0,onUpdate:e=>{1!==e.progress||t||(document.querySelector(".banner-hero-clip")?.classList.remove("banner-hero-clip"),document.querySelectorAll(".anim-clip-circle").forEach(e=>e.classList.remove("anim-clip-circle")),document.querySelector(".banner-title").classList.add("d-none"),document.getElementById("header").classList.remove("hide-header"),t=!0,ScrollTrigger.refresh(),lenis.scrollTo(0,{immediate:!0}))},onLeave:e=>{$("#cta-mess").length&&$("#cta-mess").removeClass("hide"),$(".banner-booking").length&&$(".banner-booking").removeClass("hide");e.start;e.scroll(e.start),e.disable(),e.animation.progress(1),ScrollTrigger.refresh(),window.scrollTo({top:0,behavior:"smooth"})}}}).to(".anim-clip-circle",{clipPath:"circle(70.7% at 50% 50%)"}).to(".banner-container img",{scale:1},0)}function filterGalleryMobile(){var e=document.querySelector(".filter-mobile");if(e){let i=e.querySelector(".filter-value-select"),o=e.querySelector(".filter-head"),n=e.querySelector(".filter-body");e=n.querySelectorAll(".nav-link");i&&o&&n&&0!==e.length&&(i.addEventListener("click",()=>{o.classList.toggle("active"),n.classList.toggle("active")}),e.forEach(t=>{t.addEventListener("click",()=>{var e=t.querySelector(".title-tab");console.log(e),e&&(e=e.textContent.trim(),i.textContent=e,o.classList.remove("active"),n.classList.remove("active"))})}))}}function header(){var e=document.getElementById("hamburger");let t=document.getElementById("header-sub-menu");e.addEventListener("click",function(){this.classList.toggle("active"),t.classList.toggle("active")})}function magicCursor(){var i;window.innerWidth<992||"undefined"==typeof MouseFollower||(i=new MouseFollower({speed:.8,skewing:1,skewingText:3}),document.querySelectorAll("[data-cursor]").forEach(function(e){let t=e.getAttribute("data-cursor-text")?e.getAttribute("data-cursor-text"):"VIEW";e.addEventListener("mouseenter",()=>{i.setText(t)}),e.addEventListener("mouseleave",()=>{i.removeText()})}))}lenis.on("scroll",ScrollTrigger.update),gsap.ticker.add(e=>{lenis.raf(1e3*e)}),gsap.ticker.lagSmoothing(0);let init=()=>{gsap.registerPlugin(ScrollTrigger),customDropdown(),bookingForm(),sectionAccommodation(),swiperFacility(),ctaMess(),distortionImg(),swiperAccommodation(),loadingBanner(),filterGalleryMobile(),header(),magicCursor()},isLinkClicked=(preloadImages("img").then(()=>{init()}),!1);$("a").on("click",function(e){!this.href||this.href.match(/^#/)||this.href.match(/^javascript:/)||(isLinkClicked=!0)}),$(window).on("beforeunload",function(){isLinkClicked||$(window).scrollTop(0),isLinkClicked=!1});